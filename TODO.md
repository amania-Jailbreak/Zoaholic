# Zoaholic Project TODO List

このドキュメントは、Zoaholicプロジェクトの今後の開発タスクをまとめたものです。
各タスクには優先度と詳細な説明が含まれています。

---

## 1. WebUIの操作性向上 (Priority: High)

### 1.1. アップデート対象クライアントの選択
- **現状:** 現在、WebUIの「Operations」セクションで、アップデート対象のクライアントホスト名をテキスト入力フィールドに手動で入力する必要がある。
- **目標:** WebUIに表示されているアクティブなクライアントのリストから、ドロップダウンメニューやチェックボックスなどで選択できるようにする。これにより、入力ミスを防ぎ、操作性を向上させる。
- **詳細:**
    - `public/script.js` で、ホストから受信したクライアントリストを元に、選択可能なUI要素（例: `<select>` タグやラジオボタン）を動的に生成する。
    - ユーザーが選択したクライアント名を「Update Client」ボタンのクリックイベントで取得し、ホストに送信する。

### 1.2. アップデートファイルの指定方法の改善
- **現状:** `public/script.js` 内に、GitHubリポジトリのURL (`repoUrl`) と更新対象ファイル (`filesToUpdate`) がハードコードされている。
- **目標:** WebUIからこれらの情報を入力できるようにする。これにより、柔軟なアップデートが可能になる。
- **詳細:**
    - `public/index.html` に、`repoUrl` と `filesToUpdate` を入力するためのテキストフィールドや、ファイルパスを追加するための動的なUI要素を追加する。
    - `public/script.js` で、これらの入力値を取得し、ホストへのアップデートリクエストのボディに含める。
    - `filesToUpdate` は、`sourcePath` と `targetPath` のペアを複数指定できるようにする。

---

## 2. プラグインシステムの拡張 (Priority: Medium)

### 2.1. プラグイン設定の永続化
- **現状:** プラグインは設定を保持するメカニズムを持たない。
- **目標:** 各プラグインが独自の永続的な設定を持つことができるようにする。
- **詳細:**
    - ホスト側で、プラグインごとに設定ファイルを保存・読み込むための共通のAPIを提供する（例: `plugins/config/pluginName.json`）。
    - プラグインは `init` 時に設定を読み込み、実行中に変更された場合は保存する。

### 2.2. WebUIからのプラグイン設定変更
- **現状:** プラグインの設定をWebUIから変更する手段がない。
- **目標:** WebUIにプラグインごとの設定画面を設け、ユーザーが設定値を変更できるようにする。
- **詳細:**
    - ホスト側で、プラグインが自身の設定スキーマ（どのような設定項目があるか）を定義し、それをWebUIに提供するAPIを実装する。
    - WebUIは、提供されたスキーマに基づいて動的に設定フォームを生成し、ユーザーの入力をホストに送信する。
    - ホストは受信した設定を検証し、プラグインの設定ファイルに保存する。

### 2.3. プラグインの有効/無効切り替え
- **現状:** プラグインは常に有効な状態でロードされる。
- **目標:** WebUIから個々のプラグインを動的に有効/無効に切り替えられるようにする。
- **詳細:**
    - ホスト側で、プラグインの有効/無効状態を管理するメカニズム（例: 設定ファイルに保存）を実装する。
    - WebUIに、各プラグインの有効/無効を切り替えるためのトグルスイッチなどを追加する。
    - 状態変更時に、ホストはプラグインを適切にアンロード/ロードする。

---

## 3. バックアップ機能の実装 (Priority: Medium)

### 3.1. ホスト側での定期バックアップ
- **現状:** バックアップ機能は未実装。
- **目標:** ホストが15分ごとに指定されたディレクトリのバックアップを作成する。
- **詳細:**
    - `src/host.js` に、定期実行タスク（例: `setInterval`）を追加する。
    - バックアップ対象ディレクトリを指定できるようにする（設定ファイルで管理）。
    - バックアップは、タイムスタンプ付きのアーカイブファイル（例: `.zip` や `.tar.gz`）として保存する。

### 3.2. クライアントへの分散保存
- **現状:** バックアップの分散保存は未実装。
- **目標:** 作成されたバックアップファイルを、接続されているクライアントに分散して保存する。
- **詳細:**
    - ホストからクライアントへバックアップファイルを送信するためのWebSocketメッセージ形式を定義する。
    - クライアント側で、受信したバックアップファイルを保存するロジックを実装する。
    - どのクライアントにどのバックアップを保存したかをホスト側で管理する。

---

## 4. レスキューモードの強化 (Priority: Low)

### 4.1. GitHub安定版Releaseからの復元
- **現状:** レスキューモードはシミュレーションのみ。
- **目標:** GitHubの安定版Releaseから、実際のファイルをダウンロードして復元する。
- **詳細:**
    - GitHub Releases APIを使用して、最新の安定版リリースを特定する。
    - リリースアセット（例: 圧縮されたコード）をダウンロードし、展開して適用する。

### 4.2. 設定の初期化
- **現状:** レスキューモードはシミュレーションのみ。
- **目標:** クライアントの設定を初期状態に戻す。
- **詳細:**
    - クライアントの設定ファイルを特定し、削除またはデフォルト値で上書きする。

---

## 5. 通知機能の実装 (Priority: Low)

### 5.1. Discord/Eメール送信機能の統合
- **現状:** 通知機能は未実装。
- **目標:** 特定のイベント（例: クライアントの切断、アップデートの成功/失敗）が発生した際に、DiscordやEメールで通知を送信する。
- **詳細:**
    - ホスト側で、Discord WebhookやEメール送信のためのライブラリを導入する。
    - 通知設定（Webhook URL、Eメールアドレスなど）を管理する。
    - 通知をトリガーするイベントを定義する。

---
